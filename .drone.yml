workspace:
  base: /drone
  path: /tmp

pipeline:
  # build:
  #   image: golang:1.9
  #   commands:
  #     - env
  #   when:
  #     event: [push]
  docker_make_tags_file:
    image: eu.gcr.io/bold-upgrade-182112/teston-gcloud
    pull: true
    commands:
      - pwd
      - ls
      - teston-docker-make-tags-file

  docker_push_image:
    image: plugins/gcr
    registry: eu.gcr.io
    repo: bold-upgrade-182112/teston-pg
    secrets: [ gcr_json_key ]

  k8s_deploy_dev:
    image: eu.gcr.io/bold-upgrade-182112/teston-gcloud
    commands:
      - teston-docker-custom-tag-image dev
      - teston-k8s-deploy-image dev
